### 总结

本文提出了一种用于**跟踪受约束非线性系统** **piecewise 参考指令** 的 MPC，该控制器能够处理片断恒定设定点信号的**突然大幅变化**。

该控制器将人工参考作为额外的决策变量，并使预测轨迹与人工参考的跟踪误差以及该参考与所提供设定点之间的距离最小化。

稳定设计基于终端成本函数和终端约束区域的适当选择。实践证明，使用终端约束和不使用终端约束都能实现稳定。

假定参考值在足够长的时间内保持不变，如果是容许（admissible，可实现）的，控制器会渐近地将系统导向参考值。否则，受控系统将收敛到容许的稳定状态，使成本函数最小化。



> 该控制器将人工参考作为额外的决策变量，并使预测轨迹与人工参考的跟踪误差以及该参考与所提供设定点之间的距离最小化。

这里人工参考作为额外的决策变量的作用即为参考管理（reference governor），保证的是递归可行性。稳定性的保证还是通过终端约束和终端成本。



### 系统模型

模型：

<img src=".\img\01.png" alt="01" style="zoom:80%;" />

约束：

<img src=".\img\02.png" alt="02" style="zoom:80%;" />

稳态：

<img src=".\img\03.png" alt="03" style="zoom:80%;" />

文章为了防止约束“**激活**”（active），建立了受限（restricted）约束集：

这里的激活我理解为数值达到约束边界。

<img src="E:\Library\硕士实验室\MPC\Note\2024_5\img\04.png" alt="04" style="zoom:80%;" />

$\varepsilon$ 是一个非常小的正数。

那么约束未激活的稳态集合可以表示为：

<img src="E:\Library\硕士实验室\MPC\Note\2024_5\img\05.png" alt="05" style="zoom:80%;" />

那么集合 $Z_s$ 内的稳态就可以逼近约束边界但不激活约束。



**假设1：** 稳态可以由目标输出 $y_s$ 唯一决定，且连续变化：

<img src="E:\Library\硕士实验室\MPC\Note\2024_5\img\06.png" alt="06" style="zoom:80%;" />



针对这个非线性受约束系统，要设计一个 MPC ：对于给定的参考点（设定点或输出目标）$y_t$，闭环系统是稳定的，能**满足约束条件**，并收敛（尽可能接近）到由给定设定点 $y_t$ 计算得到的平衡点。此外，即使设定点 $y_t$ 突然变为一个不同恒定值，也要**满足闭环稳定性**。



### MPC 设计

<img src="E:\Library\硕士实验室\MPC\Note\2024_5\img\07.png" alt="07" style="zoom:80%;" />

前三项用于衡量跟踪误差，最后一项衡量参考指令的偏差。

结合约束、不变集，写出优化问题：

<img src="E:\Library\硕士实验室\MPC\Note\2024_5\img\08.png" alt="08" style="zoom:80%;" />

稳态的对应计算公式 (9 g) 如果计算不出来，也可以直接替换为：

<img src="E:\Library\硕士实验室\MPC\Note\2024_5\img\09.png" alt="09" style="zoom:80%;" /> 



### 不变集的计算

<img src="E:\Library\硕士实验室\MPC\Note\2024_5\img\10.png" alt="10" style="zoom:80%;" />