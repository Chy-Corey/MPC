## 保障安全的Control Barrier Function MPC

MPC 为了实现最佳性能，通常使状态和输入维持在约束的**极限附近**，这无法保证安全问题（可能会产生碰撞）。



### 距离约束 MPC

<img src=".\img2\01.png" alt="01" style="zoom:67%;" />

其中 g 代表安全距离约束。



### 控制障碍函数 CBF

一个控制障碍函数 $h(x)$ 满足以下条件：

- $h(x)$  在状态空间内是一个连续可微函数。
- 安全集合定义为： $C=\{x∈R^n∣h(x)≥0\}$



为了确保系统状态始终处于安全集合$C$ 内，需要控制输入 u 满足以下条件： 

$\dot{h}(x)≥−α(h(x))$  其中， $\alpha$ 通常选择为线性函数，例如 $α(h)=λh$，其中 $λ>0$ 。

设系统状态方程为：$\dot{x} = f(x) + g(x)u$ ，那么使用链式法则，可以表示：
$$
\dot{h}(x) = \frac{∂h}{∂f}(f(x)+g(x)u) \geq -\alpha(h(x))
$$
以上就是控制障碍函数作为约束条件时，能够保证安全（保持在安全距离）。

对 $\dot{h}(x)≥−α(h(x))$ 的解释：

- 当 $h(x)=0$ 时，不等式变为 $\dot{h}(x)≥0$ ，这意味着 $h(x)$ 不会变负，因此 $x$  不会离开安全集合 $C$ 。

- 当 $h(x)>0$  时，不等式 $\dot{h}(x)≥−α(h(x))$ 确保了 $h(x)$ 的减少率受限，即 $h(x)$ 不会快速减少到负值。这确保了状态在有限时间内不会离开安全集合 $C$ 。

 

### CBF-MPC

<img src=".\img2\02.png" alt="02" style="zoom:67%;" />



### 具体的 CBF 例子

<img src=".\img2\03.png" alt="03" style="zoom:80%;" />



![04](.\img2\04.png)



### 结合 RG-MPC-AUV

增加一个线性的 CBF 作为约束即可。

