## Fault-Tolerant Control for AUVs Using a Single Thruster  

### QUESTIONS

1. [问题1](#section1)为什么要采取螺旋移动的方式，是不得不这样吗？
2. 这种螺旋移动的方式和普遍的冗余补偿有什么不同？（性能，难易程度，对执行机构的要求）
3. 能不能把这两种策略（螺旋移动，冗余补偿）结合起来？





### ABSTRACT & INTRODUCTION

容错控制分为三个模块：fault detection, fault isolation, fault accommodation。

- 故障检测：发现故障
- 故障隔离：识别故障原因和故障位置
- 故障调节：执行故障时的控制

本文着重于第三点 fault accommodation 。



针对故障情况下的控制，分为三种情况：

1. 故障前是过驱动的，故障后仍然保持全自由度。
2. 故障后可能会降低自由度，但仍然可以有足够的控制措施，以保持适当的行为，并对故障进行补偿。
3. 故障前就是欠驱动的，故障后可能只有一两个自由度（比如只有一个 thruster 起作用）。



对第一种情况，处理方式是直接使用冗余的控制器进行补偿，即重构控制器。

对第二种情况，故障后进入欠驱动的情况，依然可以进行控制重构。

对第三种情况，极端情况下故障后只有一个推进器可用。<a id="section1">问题1</a>本文针对这种情况研究了临界故障导致欠驱动飞行器可用**自由度减少的情况**。此外，本文还考虑了**只有一个推进器可用于控制飞行器动态的极端情况**。在这种情况下，对可用推进器的持续输入将导致飞行器转圈。因此，最重要的是设计一个适当的控制法则，**使产生的轨迹在平均值上遵循所期望的方向，并将飞行器驶向安全点**。考虑到可以对剩余推进器应用一组离散的控制输入，通过设计这些控制动作的**切换时间**，使航行器以螺旋状路径移动，遵循所需的轨迹（真实轨迹的平均值遵循所需轨迹）。



所提出的策略可应用于多个飞行器，因为它不需要飞行器的详细模型，也不需要精确的控制参数调整，即使是非最佳参数也能提供令人满意的结果。



### PROBLEM FORMULATION

考虑一种由两个导弹形状的本体组成的自动潜航器，如图 1 所示的 MEDUSA 级自动潜航器。这种潜航器有**两个正面推进器控制前进速度和偏航率，两个垂直推进器控制深度**，但动力不足。自动潜航器具有正浮力，这意味着在发生故障时，无需额外的控制操作即可**浮出水面**。因此，在水平面（即二维）上研究了飞行器在海面上的紧急控制。

![02-01](E:\Library\硕士实验室\MPC\Note\2024_3\image\02-01.png)



body frame 下的速度向量：$\gamma = [u,v,r]^T$ 表示纵摆速度，横摆速度，方向角速度；inertial frame 下的速度向量：$V=[\dot{x}, \dot{y}]^T$ 表示沿 x 和 y 轴的速度。

<img src="E:\Library\硕士实验室\MPC\Note\2024_3\image\02-02.png" alt="02-02" style="zoom:50%;" />

运动学模型：

<img src="E:\Library\硕士实验室\MPC\Note\2024_3\image\02-03.png" alt="02-03" style="zoom:80%;" />

对于水平面的动力学模型，只需要考虑两个水平推进器，每个推进器在响应控制动作时产生的力命名为 $Fs$ 和 $Fp$ :
$$
F_s(a_s) = K|a_s|a_s\\
F_p(a_p) = K|a_p|a_p
$$
$a_s$ 和 $a_p$ 分别代表右舷和左舷的控制输入。

那么总力是每个推进器提供的力的总和为 $F=F_p+F_s$，同时产生扭矩 $\tau=L(F_p-F_s)$，其中 $L$ 是每个推进器到航行器对称轴的距离。

本文考虑两个推进器之一故障，无法控制。设置为 $a_s=0$ ，即 $F_s=0$ 。那么：
$$
F = F_p\\
\tau = LF_p
$$
水平面的动力学模型为：

<img src="E:\Library\硕士实验室\MPC\Note\2024_3\image\02-04.png" alt="02-04" style="zoom:80%;" />

<img src="E:\Library\硕士实验室\MPC\Note\2024_3\image\02-05.png" alt="02-05" style="zoom:80%;" />



### CONTROL DESIGN





#### AVERAGE VELOCITY CONTROL 内环

由于只剩下一个左舷推进器，只有一个控制自由度，该控制器会同时产生向前的力和向右的旋转力矩。所以必须控制飞行器朝着**所需的方向平均移动**，即平均速度是朝着所需方向的，所以叫做平均速度控制。

以上说明了一个推进器无法独立控制两个状态量，也可以根据模型证明：

假设可以只产生向前的力，没有旋转力矩，那么 $r = 0$ ，式（5）则表示为：
$$
m_v\dot{v} + D_vv = 0
$$
这代表 $v=0$ ，即横摆速度等于零（推导省略）。那么式（6）表示为：
$$
-m_{uv}\cdot u\cdot v = \tau = L \cdot F_p
$$
然而 $v=0,F_p\neq 0$ ，假设不成立。

在这种情况下（控制自由度只有 1 ），要分析一个执行器的作用效果，当应用**恒定控制动作** $a_p = a_0$ 时，(4)-(6) 的平衡解为：

<img src="E:\Library\硕士实验室\MPC\Note\2024_3\image\02-06.png" alt="02-06" style="zoom:80%;" />

平衡解一定成立，即 u, v, r 在恒定控制输入 $a_p$ 下是稳定的，且指数收敛。

时域中的方向角速度方程可以写成 $r(t) = r_e + r_t$，其中 $r_t$ 是一个过渡项，由于指数收敛，它可以被限定为:
$$
|r_t| = |r(t) -r_e| \leq ||\gamma(t) -\gamma_e|| ≤ c_1||\gamma(0) -\gamma_e||e^{-c_2t}
$$
其中 $c_1$ 和 $c_2$ 是两个正常数。因此，偏航角可以定义为：
$$
\Psi(t) = \int_{0}^{t}(r_e + r_t)\ dt = r_et + \int_{0}^{t} r_t\ dt = r_et +\Psi_t
$$
其中，$\Psi_t$ 是一个过渡项，于某一时刻收敛到定值 $\Psi_f=\Psi_{t\rightarrow\infty}=\int_{0}^{\infty}r_t$。根据指数收敛：
$$
|\Psi_f|\leq \int_0^{\infty} |r_t|\leq \int_{0}^{\infty}c_1||\gamma(0) -\gamma_e||e^{-c_2t}=\frac{c_1}{c_2}||\gamma(0|-\gamma_e||
$$
所以 $t\rightarrow \infty$ 时的平均角速度为：
$$
\bar{r} = \lim_{t\rightarrow \infty}\frac{1}{t}\int_0^t(r_e+r_t)\ ds=r_e+\lim_{t\rightarrow \infty}\frac{\Psi_t}{t}=r_e
$$
所以当唯一的推进器以恒定量输入时，三个速度量都会指数收敛到稳定值，且其平均值就是稳定值。

那么惯性坐标系下的速度量（x, y）的均值为：
$$
\bar{\dot{x}} = \lim_{t\rightarrow \infty} \frac{1}{t}\int_{0}^{t}((u_e+u_t)\cdot \cos(r_e\cdot s+\Psi_t)-(v_e+v_t)\cdot \sin(r_e\cdot s+\Psi_t))\ ds
$$
令 $e_{\Psi}=\Psi_t-\Psi_f$ ，那么上式可以继续化简：

<img src="E:\Library\硕士实验室\MPC\Note\2024_3\image\02-07.png" alt="02-07" style="zoom:80%;" />

由于 $\Psi_t$ 会指数收敛到 $\Psi_f$ ，所以当 $s\rightarrow \infty$ 时，$\varepsilon_1$ 也会收敛到 0 。

同理 $ \sin(r_e\cdot s+\Psi_t)= \sin(r_e\cdot s+\Psi_f)+\varepsilon_2(s)$ ，$\varepsilon_2 \rightarrow 0$ 。

那么惯性坐标系下速度均值表示为：

<img src="E:\Library\硕士实验室\MPC\Note\2024_3\image\02-08.png" alt="02-08" style="zoom:80%;" />

这是这个定理的数学推导，稍微想一想就可以理解当唯一的推进器（左舷）恒定输入时，航行器就会在稳定以后原地转圈，平均速度为 0 ，合速度为 $V_e=\sqrt{u_e^2+v_e^2}$ ，方向角速度为 $r_e$ ，转圈的半径 $R_e=\frac{V_e}{r_e}$ （微分，弧长/弧度）。

控制目标是以一定的平均速度向目标点运动，那么就需要获得**不为零的平均前进速度**，必须打破圆轨迹的对称性，因此**不适合采用恒定输入控制动作**。文章提出以下控制规律：

<img src="E:\Library\硕士实验室\MPC\Note\2024_3\image\02-09.png" alt="02-09" style="zoom:80%;" />

(11) 式的概念是，当航行器朝东（$\sin(\Psi ) > 0$）与朝西（$\sin(\Psi ) < 0$）时，控制作用将不同，这打破了圆形轨迹的对称性，如下图所示。

<img src="E:\Library\硕士实验室\MPC\Note\2024_3\image\02-10.png" alt="02-10" style="zoom:50%;" />



所选角度对应的符号取决于所需的运动方向。比如这张图，当航行器朝东（$\sin(\Psi ) > 0$）、朝西（$\sin(\Psi ) < 0$），那么朝东时转圈半径 $R_e$ 减小，朝西时增大，航行器就会逐渐向南移动。

控制法则的工作原理如下： 考虑航行器顺时针转动（方向角速度 $r > 0$），轨迹近似圆形（$\Delta a$ 较小时），由于 u > 0 和 v < 0，航行器方向指向圆形轨迹的内部。当 $\Psi = 2nπ$ 时，航行器正好指向北方，这也是航行器的方向角从西向东改变方向的起点（图 3 中的 A 点），沿着图 3 中的红色路径前进。到达 $(2n + 1)π$ 时，航行器正好指向南方（图 3 的 B 点），控制法则再次切换为，轨迹为蓝色路径。 

考虑控制作用 (11) 下的系统 (1) - (6)，则可以选择 $a_0$ 和 $\Delta a$，使系统的速度收敛到一个指数稳定的持续振荡极限周期，此外，系统的**平均速度**也指数收敛到一个稳定的固定值： $[\bar{\dot{x}}, \bar{\dot{y}}]^T\rightarrow [V_{xf}, V_{yf}]^T$。

接下来对航行器运行一圈的平均速度进行计算，以确定平均速度的方向：

<img src="E:\Library\硕士实验室\MPC\Note\2024_3\image\02-11.png" alt="02-11" style="zoom:80%;" />

这里的 T 代表绕一圈所有的时间，角标带 * 表示是稳定值。

文章证明了这一控制方法的指数收敛稳定性，这里省略。

接下来探讨将合速度 $V_e=\sqrt{u_e^2+v_e^2}$ 分开时的半径：

<img src="E:\Library\硕士实验室\MPC\Note\2024_3\image\02-12.png" alt="02-12" style="zoom:80%;" />

通过二阶泰勒展开线性化：

<img src="E:\Library\硕士实验室\MPC\Note\2024_3\image\02-15.jpg" alt="02-15" style="zoom:20%;" />

上文第一段表示对于**纵摆速度 u ，旋转半径在控制输入切换前后是一样的**；而**对于横摆速度 v， 旋转半径会改变**。当控制输入 $F_p$ 增大时，旋转半径减小，$F_p$ 减小时，旋转半径增大。

那么旋转一周的平均速度可以表示为：

<img src="E:\Library\硕士实验室\MPC\Note\2024_3\image\02-14.png" alt="02-14" style="zoom:80%;" />

<img src="E:\Library\硕士实验室\MPC\Note\2024_3\image\02-13.png" alt="02-13" style="zoom:80%;" />

至于如何控制航行器向对应的方向以平均速度行驶，设计也很简单。上述方法只说明了可以通过（11）式的控制方法来达到转圈前进的效果，但无法控制前进的方向：

<img src="E:\Library\硕士实验室\MPC\Note\2024_3\image\02-09.png" alt="02-09" style="zoom:80%;" />

那么只需要计算出出（11）式能够使航行器的平均偏航角达到多少，再进行加减即可：

<img src="E:\Library\硕士实验室\MPC\Note\2024_3\image\02-15.png" alt="02-15" style="zoom:80%;" />



#### POSITION CONTROL 外环

一旦可以控制航行器的平均速度，就必须定义一个控制法则，使航行器到达所需的参考位置 $X_r = [x_r, y_r]^T$ 附近。从航行器位置 $X = [x, y]^T$ 到目标点 $X_r$ 的矢量方向用作平均前进速度方向的参考。

<img src="E:\Library\硕士实验室\MPC\Note\2024_3\image\02-16.png" alt="02-16" style="zoom:80%;" />



