### Chapter 1

#### 约束

对于状态和控制输入的约束，可以表示为：
$$
Eu(k)\leq e\ \ \ \ E=\begin{bmatrix} 
I \\
-I
\end{bmatrix}\ \ \ \ e=\begin{bmatrix} 
\overline{u} \\
-\underline{u}\ 
\end{bmatrix}\\
Fu(k)\leq f\ \ \ \ F=\begin{bmatrix} 
I \\
-I
\end{bmatrix}\ \ \ \ f=\begin{bmatrix} 
\overline{x} \\
-\underline{x}\ 
\end{bmatrix}
$$
对于控制输入变化率约束的表达，可以增广状态：

![01](.\image\01.png)

![01](.\image\02.png)

对于状态的变化率约束，可以通过状态空间直接得到：
$$
\Delta x(k+1)=A\Delta x(k)+B\Delta u(k)
$$


#### 软约束

在优化问题中，对于控制输入的约束通常代表着真实的物理限制，必须要遵守；而对状态或测量输出的约束通常代表着对系统的“要求”。这些要求可能无法达到，MPC 的控制器需要实时决策这些约束是否不可行，如果不可行就需要放松这些约束（具体怎么做在第二章）。所以对于控制输入就使用硬约束，对于状态和输出就使用软约束。

给系统加入软约束，由于软约束是需要通过反馈来决定其大小的，所以可以增广至控制输入中：

![03](.\image\03.png)

#### 优化多级函数

对于线性时不变系统：

![04](.\image\04.png)

MPC 调节器的目标函数：

![05](.\image\05.png)

这是一个多级函数，$x(k+1)$ 由 $x(k)$ 和 $u(k)$ 决定，依次递推，写成简单的形式：

![06](.\image\06.png)

这里的 $w$ 类似 $u_0$ ，那么可以从后向前优化(动态规划)：

![07](.\image\07.png)

书里还写了前向DP（用于状态估计），与动态规划类似，只是方向不同。

#### 动态规划求解

![05](.\image\05.png)

改写为以下形式：

![08](.\image\08.png)

使用动态规划，将$x(N)$ 用 $x(N-1)$ 和 $u(N-1)$表示：

![09](.\image\10.png)

对 $u(N-1)$ 求导，使导数等于 0 可得到最优解。

![09](.\image\09.png)

由此依次向前求解直到 $x(0)$ 即可得到最优解序列。

#### 线性二次调节器的收敛问题

